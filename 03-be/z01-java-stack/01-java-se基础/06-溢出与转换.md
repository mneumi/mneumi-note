## 溢出

### 整数溢出

整数由于存在范围限制，如果计算结果超出了范围，就会产生溢出，而溢出**不会出错**，却会得到奇怪的结果

```java
public class Main {
    public static void main(String[] args) {
        int x = 2147483640;
        int y = 15;
        int sum = x + y;
        System.out.println(sum); // -2147483641
    }
}
```

### 浮点数溢出

整数运算在除数为`0`时会报错，而浮点数运算在除数为`0`时，不会报错，但会返回几个特殊值

- `NaN`表示Not a Number
- `Infinity`表示无穷大
- `-Infinity`表示负无穷大

```java
double d1 = 0.0 / 0; // NaN
double d2 = 1.0 / 0; // Infinity
double d3 = -1.0 / 0; // -Infinity
```



## 类型提升

### 概述

在运算过程中，如果参与运算的两个数类型不一致，那么计算结果会自动转为较大的类型

### 例子

#### 例子1：低精度整型提升为高精度整型

例如：`short`和`int`计算，结果总是`int`，原因是`short`首先自动提升为`int`

```java
public class Main {
    public static void main(String[] args) {
        short s = 1234;
        int i = 123456;
        
        int x = s + i; // s自动转型为int
        short y = s + i; // 编译错误!
    }
}
```

#### 例子2：整型提升为浮点型

例如：如果浮点型与整型进行运算，那么整型可以自动提升到浮点型

```java
public class Main {
    public static void main(String[] args) {
        int n = 5;
        double d = 1.2 + 24.0 / n; // 6.0
        System.out.println(d);
    }
}
```



## 强制类型转换

### 概述

强制类型转换语法：`(类型)`

### 例子

#### 例子1：高精度整型强制转为低精度整型

例如：将`int`强制转型为`short`

```
int i = 12345;
short s = (short) i; // 12345
```

要注意，超出范围的强制转型会得到错误的结果，原因是转型时，`int`的两个高位字节直接被扔掉，仅保留了低位的两个字节

```java
public class Main {
    public static void main(String[] args) {
        int i1 = 1234567;
        short s1 = (short) i1; 
        System.out.println(s1); // -10617
        
        int i2 = 12345678;
        short s2 = (short) i2; 
        System.out.println(s2); // 24910
    }
}
```

#### 例子2：浮点型强制转换为整型

可以将浮点数强制转型为整数：在转型时，浮点数的小数部分会被丢掉

如果转型后超过了整型能表示的最大范围，将返回整型的最大值

```java
int n1 = (int) 12.3; // 12
int n2 = (int) 12.7; // 12
int n2 = (int) -12.7; // -12
int n3 = (int) (12.7 + 0.5); // 13
int n4 = (int) 1.2e20; // 2147483647
```

如果要进行四舍五入，可以对浮点数加上0.5再强制转型：

```java
public class Main {
    public static void main(String[] args) {
        double d = 2.6;
        int n = (int) (d + 0.5);
        System.out.println(n);
    }
}
```
