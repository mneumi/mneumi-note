## nginx配置文件

### 配置文件路径

配置文件路径：`/etc/nginx/nginx.conf`

### 配置文件组成

一共由三部分组成：全局块，events块，http块



## 全局块

### 概述

从配置文件开始到events块之间的内容，主要会设置一些影响nginx服务器整体运行的配置指令，主要包括

* 运行nginx服务器的用户（组）
* 允许生成的worker process数
* 进程PID存放路径
* 日志存放路径和类型，
* 配置文件的引入等小
* ...

### 示例

```nginx
# nginx并发处理的值，值越大，可以支持的并发处理量也越大，但是会受到硬件和软件的制约
worker_process 1;
```



## events块

### 概述

events块涉及的配置主要影响nginx服务器与用户的网络连接，常用的设置包括

* 是否开启多worker process下的网络连接进行序列化
* 是否允许同时接收多个网络连接
* 选取哪种事件驱动模型来处理连接请求
* 每个worker process可以同时支持的最大连接数等

### 示例

```nginx
# 每个worker process支持的最大连接数为 1024
worker_connections 1024;
```



## http块

### 概述

http块是配置最频繁，最常用的部分，常用于配置：反向代理，静态资源服务器，缓存

注意：http块分为`http全局块`和`server块`两类子块，`server块`可以有多个，`http全局块`只有一个

### http全局块

包含：文件引入，MIME-TYPE定义，日志自定义，连接超时时间，单连接请求数上限等

### server块

这块与虚拟主机有密切关系，每个http块可以包含多个server块，而每个server块相当于一个虚拟主机

而每个server块也分为全局server块和多个location子块

全局server块：常用于配置虚拟主机的监听配置和本虚拟主机的名称和IP配置

location块：一个server可以有多个location块，location块常用于对虚拟主机名称之外的路径进行匹配，包括地址定向，数据缓存，应答控制等等



## 路径匹配规则

| 规则 | 说明                                                         |
| ---- | ------------------------------------------------------------ |
| `=`  | 用于不是正则表达式的URI前<br />要求请求字符串与URI严格匹配，如果匹配成功，则停止向下搜素，并立即处理该请求 |
| `~`  | 用于是正则表达式的URI前<br />区分大小写                      |
| `~*` | 用于是正则表达式的URI前<br />不区分大小写                    |
| `^~` | 用于不是正则表达式的URI前<br />要求nginx服务器找到标识URI和请求字符串匹配程度最高的location后，立即使用此location处理该请求，并且不再继续匹配 |