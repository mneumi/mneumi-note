```html
<!--
enctype='application/x-www-form-urlencoded' (默认值) 功能：键值对化，对表单数据进行编码

<input type='text' name='username' />
<input type='password' name='password' />

FormData ==> username=123&password=9876
-->
```

```html
<!--
enctype="multipart/form-data" 这是同步上传，用的是HTML功能，没有用到 JS
-->
```

```html
<!--
enctype="multipart/form-data" 这是同步上传，用的是HTML功能，没有用到 JS

<input type="file" name="file" multiple /> 多文件上传
-->
```

### FormData

```html
<input type='text' id='username' />
<input type='text' id='password' />
<input type='submit' id="submitBtn" value='提交' />

<script>
    const oUsername = document.getElementById('username');
    const oPassword = document.getElementById('password');
    const oSubmitBtn = document.getElementById('submitBtn');
    
	const fd = new FormData();
    
    oSubmitBtn.onclick = function() {
        fd.append('Username', oUsername.value);
        fd.append('Password', oPassword.value);
        
        console.log('username: ' + fd.get('Username'));
        console.log('password: ' + fd.get('Password'));
        
        fd.set("Username", '李四');
        fd.has("Password");
        fd.delete("Password");
        // 不存在的数据，显示的是 null，而不是 undefined
    }
</script>
```

## 异步上传

```html
<style>
    ul {
        padding: 0;
        margin: 0;
        list-style: none;
        margin-top: 100px;
    }
    
    .progress-bar {
        width: 300px;
        height: 400px;
        border: 1px solid #666;
        text-align: center;
    }
    
    .progress {
        width: 50%;
        height: 100%;
        background-color: green;
    }
    
    .error-info {
        line-height: 40px;
        font-size: 14px;
        color: #333;
    }
</style>

<input type='file' id='file' multiple />
<input type="submit" id='submitBtn' value='上传' />

<ul class="progress-wrap">
    <li class="progress-bar">
    	<div></div>
        <span class="error-info">文件类型错误</span>
    </li>
</ul>

<script>
	const oFile = document.getElementById('file');
	const oSubmit = document.getElementById('submitBtn');
    const oProgressWrap = document.getElementByClassName('progress-wrap')[0];
    
    oFile.onchange = function() {
        // console.log(oFile.files);
        var files = oFile.files;
        var fileLen = files.length;
        
        if (fileLen <= 0) {
            console.log('您还没有选择图片');
            return;
        }
        
        if (fileLen > 5) {
            console.log("最多可同时上传5张图片");
            return;
        }
        
        oProgressWrap.innerHTML = '';
        
        var fileName = '', fileSize = 0, maxSize = 1048576, fd=null;
        
        for (var i=0; i<fileLen; i++) {
            fileName = files[i].name;
            fileSize = files[i].size;
            
            if (/.(gif|jpg|jpeg|png)$/.test(fileName)) {
                errorInfo += `${fileName}不是图片类型`;
            }
            
            if (fileSize > maxSize) {
                errorInfo += `${fileName}超过可上传大小`;
            }
            
            var oProgressBar = document.createElement('li');
            oProgress.className = 'progress-bar';
            
            oProgress.appendChild(oProgressBar);
            
            if (errorInfo !== '') {
                oProgerss.innnerHTML = '<span class="error-info>"' + errorInfo + '</span>'
            } else {
                oProgerss.innnerHTML = '<div class="progress"></div>';
                
                fd = new FormData();
                fd.append('file', files[i]);
                
                var o = window.XMLHttpRequest ? new XMLHttpRequest() : ActiveObject('Microsoft.XMLHTTP');
                
                o.open('post', 'server/upload.php');
                
         		(function(i) {  
                    o.upload.onprogress = function(e) {
                        let percent = e.loaded / e.total * 100 + %;
                        var thisProgressBar = oProgerssWrap.getElementByClassName('progress-bar')[i];

                        thisProgressBar.getElementByClassName('progress')[0].style.width = percent;
                    }
                }) 
                
                o.send(fd);
            }
        }
    }
</script>
```

